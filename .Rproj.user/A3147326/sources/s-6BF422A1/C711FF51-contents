# Suriel Quevedo Ortiz

library(tidyverse)
library(dplyr)
datos <- read.csv("solar.csv", header = TRUE)
# a)
names(datos)

# b)
dim(datos)
object.size(datos)

# c)
head(datos, 6)

# d)
str(datos$MonthOfYear)
datos$MonthOfYear <- as.character(datos$MonthOfYear)
datos <- mutate(datos, MonthOfYear = ifelse(MonthOfYear == 1, "ENERO",
                                            ifelse(MonthOfYear == 2, "FEBRERO",
                                                   ifelse(MonthOfYear == 3, "MARZO",
                                                          ifelse(MonthOfYear == 4, "ABRIL",
                                                                 ifelse(MonthOfYear == 5, "MAYO",
                                                                        ifelse(MonthOfYear == 6, "JUNIO",
                                                                               ifelse(MonthOfYear == 7, "JULIO",
                                                                                      ifelse(MonthOfYear == 8, "AGOSTO",
                                                                                             ifelse(MonthOfYear == 9, "SEPTIEMBRE",
                                                                                                    ifelse(MonthOfYear == 10, "OCTUBRE",
                                                                                                           ifelse(MonthOfYear == 11, "NOVIEMBRE",
                                                                                                                  ifelse(MonthOfYear == 12, "DICIEMBRE","NO_ESPECIFICADO")))))))))))))
str(datos$MonthOfYear)

# e)
fe <- group_by(datos, MonthOfYear)
fe <- summarize(fe, temp_max = max(Temperature, na.rm = TRUE),
                     temp_min = min(Temperature,na.rm = TRUE),
                     hum_max = max(Humidity, na.rm = TRUE),
                     hum_min = min(Humidity, na.rm = TRUE))

fe

# f)
fe <- mutate(datos, Temperature = Temperature * (1.8) + 32)

# g)
fe <- group_by(fe, Year)
fe <- summarize(fe, prom_anual = mean(Temperature, na.rm = TRUE))
barplot(fe$prom_anual,
        main = "Promedio de temperaturas por año",
        xlab = "Años",
        ylab = "Grados farenheit",
        names.arg = fe$Year,
        col = "blue", horiz = FALSE)

# h)
ggplot(data = datos) +
  geom_point(mapping = aes(x = WindSpeed, y = WindDirection), color = "red", alpha = 0.6)

# i)
ggplot(data = datos) +
  geom_point(mapping = aes(x = Temperature, y = Humidity, color = MonthOfYear, shape = MonthOfYear))

# j)
ggplot(data = datos) +
  geom_point(mapping = aes(x = Temperature, y = Humidity)) +
  facet_wrap(~ Year)
